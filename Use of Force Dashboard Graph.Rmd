---
title: "Use of Force Dashboard Graph"
output: html_document
---

## Load packages and setup

```{r}

library(tidyverse)
library(dplyr)

```


```{r}

theme_set(theme_light())

```


## Load the file

```{r}

df <- read_csv("Use_of_Force.csv")

```
## convert officerID
```{r}
df <- df %>%
  mutate(Officer_ID = as.character(Officer_ID))
```

## Make your plot

```{r}
head(df)
```


```{r}

```
```{r}
df %>%
  group_by(Officer_ID, Incident_Type) %>%
  count %>%
  pivot_wider(id_cols=Officer_ID,
              names_from=c(Incident_Type),
              values_from=c(n),
              values_fill=0)
```


Suppose you want to make a bar graph of the number of each type of use of force.

```{r}

df1 <- df %>% 
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "Type of Use of Force", y = "Officer ID")

df1

```

The following 4 graphs are all very similar, the only thing that changes is the incident type specified in the filter method. For a reactive application such as the dashboard, I reccomend the 4 graphs be combined into one, with some sort of button or slider to switch between the UOF types.
```{r}

UOF_lv1 <- df %>% 
  filter(Incident_Type == 'Level 1 - Use of Force') %>%
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "UOF Level 1 Incidents Reported", y = "Officer ID")

UOF_lv1

```

```{r}

UOF_lv2 <- df %>% 
  filter(Incident_Type == 'Level 2 - Use of Force') %>%
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "UOF Level 2 Incidents Reported", y = "Officer ID")

UOF_lv2

```


```{r}

UOF_lv3 <- df %>% 
  filter(Incident_Type == 'Level 3 - Use of Force') %>%
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "UOF Level 3 Incidents Reported", y = "Officer ID")

UOF_lv3

```

```{r}

UOF_OIS <- df %>% 
  filter(Incident_Type == 'Level 3 - OIS') %>%
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "OIS Incidents Reported", y = "Officer ID")

UOF_OIS

```


## Export your figure


```{r}

png('dashboard_plot_Vache.png')

df %>% 
  count(Officer_ID) %>% 
  mutate(Officer_ID = fct_reorder(Officer_ID, n, .desc = FALSE)) %>% 
  top_n(25, Officer_ID) %>%
  ggplot(aes(x = n, y = Officer_ID)) +
  geom_col() +
  labs(x = "Times Force Used", y = "Officer ID")


dev.off()

```

A possible description of this plot is:

This bar graph shows the total number of each level of use of force in the full data set. 


